<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"></meta>
<title th:text="${title}+'-宅着玩'"></title>
<link rel="stylesheet" href="/static/layui/css/layui.css"></link>
<link rel="stylesheet" href="/static/css/personalCenter.css" />
<style type="text/css">
.layui-input-block{
margin-left:120px;
}
.layui-form-label {
width: 90px;
}
.layui-upload-img{width:180px; height: 230px; margin: 0 10px 10px 0;}

</style>
<script src="/static/layui/layui.js"></script>
<script src="/static/js/jquery.js"></script>
<script src="/static/js/common.js"></script>
<script th:inline="javascript">
/*<![CDATA[*/  
	layui.use(['element','form','layedit','upload'], function(){
	//  document.getElementById("d1").className='layui-this'
	      var form=layui.form;
		  var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块
		  var $ = layui.jquery,upload = layui.upload;
		  var layedit=layui.layedit;
		  
		  //普通图片上传
		  var uploadInst = upload.render({
		     elem: '#uploadGameBtn'
		    ,url: '/user/gameInformation/uploadCoverImage'
		    ,size: 60 //限制文件大小，单位 KB
		    ,before: function(obj){
		      //预读本地文件示例，不支持ie8
		      obj.preview(function(index, file, result){
		        $('#uploadImage').attr('src', result); //图片链接（base64）
		      });
		    }
		    ,done: function(res){
		      //如果上传失败
		      if(res.code > 0){
		        return layer.msg('上传失败');
		      }else{
		    	  $("#game_picture").attr("value",res.data.src);//图片路径
		      }
		      //上传成功
		    }
		    ,error: function(){
		      //演示失败状态，并实现重传
		      var demoText = $('#demoText');
		      demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
		      demoText.find('.demo-reload').on('click', function(){
		        uploadInst.upload();
		      });
		    }
		  });
		  
		  var index=layedit.build('content',{
			  uploadImage:{
				  url:'/user/gameInformation/uploadContentImage',
				  type:'post'
			  }
		  });
		 
		  //监听提交
		  form.on('submit(gameSubmit)', function(data){
			  var content=layedit.getContent(index);
			  if(content==""){
				  layer.msg("请输入资源描述！");
				  return false;
			  }
			$("#content").val(content);
		    return true;
		  });
	   });
/*]]>*/
	
</script>
</head>


<body>
<div class="w1170" style="padding-bottom: 10px; overflow: visible;" th:include="common/head::#head"></div>
<div class="w1170">
		<div style="float: left; width: 200px"
			th:include="user/personalCenter/leftMenu::#lm"></div>
		<div style="float: right; width: 970px"
			th:include="user/game/page/publishGameResourcePage::#pgrPage">
		</div>
	</div>
</body>
</html>